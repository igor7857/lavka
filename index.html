<!DOCTYPE HTML>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="viewport" content="height=device-height, initial-scale=1.0">
	<meta content="text/css">
 	<title>Калькулятор лавки</title>
 	<link rel="stylesheet" href="style.css">
</head>
<body>
	<h2 style="margin-top: 20px; text-align: center; max-width: 800px; min-width: 200px;">Калькулятор лавки</h2>
	<div style="max-width: 800px; min-width: 200px; margin-right: 10px; margin-left: 10px;">
		<div style="float: left; width: 100%;">
			<div style="padding: 10px; margin-top: 20px; margin-right: 10px; margin-left: 10px; background: #ecedee; border: 2px solid #999999; text-align: left; vertical-align: middle;">
				<form name="form_цена_чм" oninput="вычислить()" onload="вычислить()">
					<p>цена товара в чм</p>
					<input type="Number" id="input_цена_чм" min="1" value="19">				
				</form>
			</div>
		</div>
	</div>

	<div style="max-width: 800px;min-width: 200px; margin-right: 10px; margin-left: 10px;">
		<div style="float: left; width: 100%;">
			<div style="background: #ecedee; border: 2px solid #999999; padding: 10px; margin: 10px;">
				<form name="form_ед_товара" oninput="вычислить()" onload="вычислить()">
					<p>единиц товара</p>
					<input type="Number" id="input_ед_товара" min="1" value="1">
					<div style="display: inline; width:">
						<button style="display: inline; width: 15%; font-size: 18px; margin-top: 5px; margin-right: 3%; margin-left: 8%; height: 35px;" onclick="fm5(); return false">-5</button>
						<button style="display: inline; width: 15%; font-size: 18px; margin-top: 5px; margin-right: 3%; margin-left: 3%; height: 35px;" onclick="fm1(); return false">-1</button>
						<button style="display: inline; width: 15%; font-size: 18px; margin-top: 5px; margin-right: 3%; margin-left: 3%; height: 35px;" onclick="f1(); return false">+1</button>
						<button style="display: inline; width: 15%; font-size: 18px; margin-top: 5px; margin-right: 3%; margin-left: 3%; height: 35px;" onclick="f5(); return false">+5</button>
					</div>	
				</form>
			</div>
		</div>
	</div>

	<div style="max-width: 800px;min-width: 200px; margin-right: 10px; margin-left: 10px;">
		<div style="float: right; width: 100%; margin-bottom: 20px;">
			<div style="padding: 10px; margin-right: 10px; margin-left: 10px; background: #ecedee; border: 2px solid #999999; text-align: right; vertical-align: middle;">
					<p id="vResult1"> руб</p>
					<p id="vResult2"> руб+голд</p>
			</div>
		</div>
	</div>
	<br>
	<br>
	<div style="max-width: 800px;min-width: 200px; margin-right: 10px; margin-left: 10px;">
		<div style="float: left; width: 100%;">
			<div style="background: #ecedee; border: 2px solid #999999; padding: 10px; margin-top: 10px; margin-left: 10px; margin-right: 10px;">
				<form name="form_продать_за" oninput="вычислить()" onload="вычислить()">
					<p>продать за</p>
					<input type="Number" id="input_продать_за" min="0" step="50">
					<br>
					<input class="checkbox" type="checkbox" id="cb_через_перекупа">
					<label for="cb_через_перекупа" style="font-size: 26px; vertical-align: bottom;">через перекупа</label>
					<p id="vGold" style="text-align: center;">с продажи</p>
					<p id="vGoldSum" style="text-align: center;">с продажи всего</p>
				</form>
			</div>
		</div>
	</div>

	<div style="max-width: 800px;min-width: 200px; margin-right: 10px; margin-left: 10px;">
		<div style="float: left; width: 100%;">
			<div style="background: #ecedee; border: 2px solid #999999; padding: 10px; margin-top: 10px; margin-left: 10px; margin-right: 10px; text-align: center; margin-bottom: 20px;">
					<p id="vKurs1kg">цена за 1000 голд</p>
					<p id="vKurs1r">за 1 руб</p>
			</div>
		</div>
	</div>

<script>
	form_цена_чм.onload = вычислить();
	function вычислить(){
		let курс = Number(0.12);
		let цена_чм = Number(form_цена_чм.input_цена_чм.value);
		let ед_товара = Number(form_ед_товара.input_ед_товара.value);
		let продать_за = Number(form_продать_за.input_продать_за.value);
		
		let result = (цена_чм * ед_товара * курс);
		result = result.toFixed(2);

		if (result >= 50) {result = Math.floor(result);};
		if (result < 50) {
			result = result * 10;
			result = Math.ceil(result);
			result = result / 10;
			result = result.toFixed(2);
		};

		let result21 = 3500 / 30750 * цена_чм * ед_товара;
		result21 = result21 * 10;
		result21 = Math.ceil(result21);
		result21 = result21 / 10;
		result21 = result21.toFixed(2);

		let result22 = (result - result21);
		result22 = result22.toFixed(2);
		result22 = result22 * 5 * 100;
		console.log(result);
		console.log(result21);
		
		let с_продажи;
		let ch = document.getElementById("cb_через_перекупа");
		if (ch.checked) {
			с_продажи = продать_за / 100 * 90;
			с_продажи = Math.ceil(с_продажи);
		}
		else {
			с_продажи = продать_за;
		};
		let с_продажи_всего = с_продажи * ед_товара;

		let Kurs1kg = цена_чм * курс / с_продажи * 1000;
		Kurs1kg = Kurs1kg.toFixed(2);
		let Kurs1r = с_продажи / (цена_чм * курс);
		Kurs1r = Math.round(Kurs1r);

		if (Kurs1kg == Infinity) {
			Kurs1kg = 0
		};

		document.getElementById("vResult1").innerHTML = result + ` руб`;
		document.getElementById("vResult2").innerHTML = result21 + ` руб + ` + result22 + ` голд`;
		document.getElementById("vGold").innerHTML = `с продажи ` + с_продажи + ` голд`;
		document.getElementById("vGoldSum").innerHTML = `с продажи всего ` + с_продажи_всего + ` голд`;
		document.getElementById("vKurs1kg").innerHTML = `цена за 1000 голд ` + Kurs1kg + ` руб`;
		document.getElementById("vKurs1r").innerHTML = `за 1 руб ` + Kurs1r + ` голд`;
	};

	function f1(){
		let ед_товара = Number(form_ед_товара.input_ед_товара.value);
		let f = Number(1) + ед_товара;
		document.getElementById("input_ед_товара").value = f;
		form_цена_чм.onload = вычислить();
	};

	function f5(){
		let ед_товара = Number(form_ед_товара.input_ед_товара.value);
		let f = Number(5) + ед_товара;
		document.getElementById("input_ед_товара").value = f;
		form_цена_чм.onload = вычислить();
	};

	function fm1(){
		let ед_товара = Number(form_ед_товара.input_ед_товара.value);
		let f = Number(-1) + ед_товара;
		document.getElementById("input_ед_товара").value = f;
		if (f < 0) {document.getElementById("input_ед_товара").value = 0;}
		form_цена_чм.onload = вычислить();
	};

	function fm5(){
		let ед_товара = Number(form_ед_товара.input_ед_товара.value);
		let f = Number(-5) + ед_товара;
		document.getElementById("input_ед_товара").value = f;
		if (f < 0) {document.getElementById("input_ед_товара").value = 0;}
		form_цена_чм.onload = вычислить();
	};
</script>

</body>
</html>